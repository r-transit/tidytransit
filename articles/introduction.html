<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to tidytransit • tidytransit</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to tidytransit">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">tidytransit</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.7.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/introduction.html">Introduction to tidytransit</a>
    </li>
    <li>
      <a href="../articles/servicepatterns.html">Service Patterns and Calendar Schedules</a>
    </li>
    <li>
      <a href="../articles/timetable.html">Generate a Departure Timetable</a>
    </li>
    <li>
      <a href="../articles/frequency.html">Transit (GTFS) Service &amp; Headway Mapping with R</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/r-transit/tidytransit/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Introduction to tidytransit</h1>
                        <h4 data-toc-skip class="author">Tom
Buckley</h4>
            
            <h4 data-toc-skip class="date">2023-06-23</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/r-transit/tidytransit/blob/master/vignettes/introduction.Rmd" class="external-link"><code>vignettes/introduction.Rmd</code></a></small>
      <div class="hidden name"><code>introduction.Rmd</code></div>

    </div>

    
    
<!-- [![CRAN -->
<!-- status](https://www.r-pkg.org/badges/version/tidytransit?)](https://cran.r-project.org/package=tidytransit) -->
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Use tidytransit to:</p>
<ul>
<li><a href="https://r-transit.github.io/tidytransit/articles/introduction.html#read-a-gtfs-feed" class="external-link">Read
a GTFS Feed into R Data Types</a></li>
<li><a href="https://r-transit.github.io/tidytransit/articles/introduction.html#feed-validation-results" class="external-link">Validate
transit feeds</a></li>
<li>
<a href="https://r-transit.github.io/tidytransit/reference/gtfs_as_sf.html" class="external-link">Convert
stops and routes to ‘simple features’</a> and <a href="https://r-transit.github.io/tidytransit/reference/plot.tidygtfs.html" class="external-link">plot
them</a>
</li>
<li><a href="https://r-transit.github.io/tidytransit/reference/travel_times.html" class="external-link">Calculate
travel times between transit stops</a></li>
<li><a href="https://r-transit.github.io/tidytransit/articles/servicepatterns.html" class="external-link">Analyse
route frequency and headways</a></li>
<li><a href="https://r-transit.github.io/tidytransit/articles/servicepatterns.html" class="external-link">Analyse
calendar data</a></li>
<li><a href="https://r-transit.github.io/tidytransit/articles/timetable.html" class="external-link">Create
time tables for stops</a></li>
</ul>
</div>
<div class="section level2">
<h2 id="installation-dependencies">Installation &amp; Dependencies<a class="anchor" aria-label="anchor" href="#installation-dependencies"></a>
</h2>
<p>This package requires a working installation of <a href="https://github.com/r-spatial/sf#installing" class="external-link">sf</a>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Once sf is installed, you can install from CRAN with: </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">'tidytransit'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># For the development version from Github:</span></span>
<span><span class="co"># install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"r-transit/tidytransit"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="the-general-transit-feed-specification">The General Transit Feed Specification<a class="anchor" aria-label="anchor" href="#the-general-transit-feed-specification"></a>
</h2>
<p>The <a href="https://gtfs.org/documentation/overview/" class="external-link">summary page
for the GTFS standard</a> is a good resource for more information on the
standard.</p>
<p>GTFS feeds contain many linked tables about published transit
schedules, service schedules, trips, stops, and routes. Below is a
diagram of these relationships and tables:</p>
<p><img src="figures/GTFS_class_diagram.svg.png" alt="gtfs-relationship-diagram"> Source: Wikimedia, user -stk.</p>
</div>
<div class="section level2">
<h2 id="read-a-gtfs-feed">Read a GTFS Feed<a class="anchor" aria-label="anchor" href="#read-a-gtfs-feed"></a>
</h2>
<p>GTFS data come packaged as a zip file of comma separated tables in
text form. The first thing tidytransit does is consolidate the reading
of all those tables into a single R object, which contains a list of the
tables in each feed.</p>
<p>Below we use the tidytransit <code>read_gtfs</code> function in order
to read a feed from the NYC MTA into R.</p>
<p>We use an example feed included in the package in the example below.
But note that you can read directly from the New York City Metropolitan
Transit Authority, as shown in the commented code below.</p>
<p>You can also read from any other URL. This is useful because there
are many sources for GTFS data, and often the best source is transit
service providers themselves. See the next section on “Finding More GTFS
Feeds” for more sources of feeds.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># nyc &lt;- read_gtfs("http://web.mta.info/developers/data/nyct/subway/google_transit.zip")</span></span>
<span></span>
<span><span class="va">local_gtfs_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, </span>
<span>                               <span class="st">"nyc_subway.zip"</span>, </span>
<span>                               package <span class="op">=</span> <span class="st">"tidytransit"</span><span class="op">)</span></span>
<span><span class="va">nyc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_gtfs.html">read_gtfs</a></span><span class="op">(</span><span class="va">local_gtfs_path</span><span class="op">)</span></span></code></pre></div>
<p>You can use <code>summary</code> to get an overview of the feed.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">nyc</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## tidygtfs object</span></span>
<span><span class="co">## files        agency, routes, stop_times, trips, shapes, transfers, calendar, calendar_dates, stops</span></span>
<span><span class="co">## agency       MTA New York City Transit</span></span>
<span><span class="co">## service      from 2018-06-24 to 2018-11-03</span></span>
<span><span class="co">## uses         stop_times (no frequencies)</span></span>
<span><span class="co">## # routes        22</span></span>
<span><span class="co">## # trips      15911</span></span>
<span><span class="co">## # stop_ids    1223</span></span>
<span><span class="co">## # stop_names   306</span></span>
<span><span class="co">## # shapes       215</span></span></code></pre>
<p>Each of the source tables for the GTFS feed is now available in the
nyc <code>gtfs</code> object. For example, stops:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">nyc</span><span class="op">$</span><span class="va">stops</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 6 × 6</span></span></span>
<span><span class="co">##   stop_id stop_name               stop_lat stop_lon location_type parent_station</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> 101     Van Cortlandt Park - 2…     40.9    -<span style="color: #BB0000;">73.9</span>             1 <span style="color: #949494;">""</span>            </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> 101N    Van Cortlandt Park - 2…     40.9    -<span style="color: #BB0000;">73.9</span>             0 <span style="color: #949494;">"</span>101<span style="color: #949494;">"</span>         </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> 101S    Van Cortlandt Park - 2…     40.9    -<span style="color: #BB0000;">73.9</span>             0 <span style="color: #949494;">"</span>101<span style="color: #949494;">"</span>         </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> 103     238 St                      40.9    -<span style="color: #BB0000;">73.9</span>             1 <span style="color: #949494;">""</span>            </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span> 103N    238 St                      40.9    -<span style="color: #BB0000;">73.9</span>             0 <span style="color: #949494;">"</span>103<span style="color: #949494;">"</span>         </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span> 103S    238 St                      40.9    -<span style="color: #BB0000;">73.9</span>             0 <span style="color: #949494;">"</span>103<span style="color: #949494;">"</span></span></span></code></pre>
<p>The tables available on each feed may vary. Below we can simply print
the names of all the tables that were read in for this feed. Each of
these is a table.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">nyc</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  [1] "trips"          "stop_times"     "agency"         "calendar"      </span></span>
<span><span class="co">##  [5] "calendar_dates" "stops"          "routes"         "shapes"        </span></span>
<span><span class="co">##  [9] "transfers"      "."</span></span></code></pre>
<div class="section level3">
<h3 id="feed-validation-results">Feed Validation Results<a class="anchor" aria-label="anchor" href="#feed-validation-results"></a>
</h3>
<p>When reading a feed, it is checked against the GTFS specification,
and an attribute is added to the resultant object called
<code>validation_result</code>, which is a tibble about the files and
fields in the GTFS feed and how they compare to the specification.</p>
<p>You can get this tibble from the metadata about the feed.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">validation_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">nyc</span>, <span class="st">"validation_result"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">validation_result</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 6 × 8</span></span></span>
<span><span class="co">##   file   file_spec file_provided_status field   field_spec field_provided_status</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>                <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>                </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> agency Required  TRUE                 agency… Condition… TRUE                 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> agency Required  TRUE                 agency… Required   TRUE                 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> agency Required  TRUE                 agency… Required   TRUE                 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> agency Required  TRUE                 agency… Required   TRUE                 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span> agency Required  TRUE                 agency… Optional   TRUE                 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span> agency Required  TRUE                 agency… Optional   TRUE                 </span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 2 more variables: validation_status &lt;chr&gt;, validation_details &lt;chr&gt;</span></span></span></code></pre>
</div>
<div class="section level3">
<h3 id="finding-more-gtfs-feeds">Finding More GTFS Feeds<a class="anchor" aria-label="anchor" href="#finding-more-gtfs-feeds"></a>
</h3>
<div class="section level4">
<h4 id="feed-registries">Feed registries<a class="anchor" aria-label="anchor" href="#feed-registries"></a>
</h4>
<p>You can find more feeds on the following sites</p>
<ul>
<li><a href="https://database.mobilitydata.org/" class="external-link uri">https://database.mobilitydata.org/</a></li>
<li><a href="https://www.transit.land/" class="external-link uri">https://www.transit.land/</a></li>
</ul>
<p>There might be other feed registries available, depending on your
area of interest. Transit agencies might also provide their feeds on
their on website.</p>
</div>
<div class="section level4">
<h4 id="using-mobilitydata">Using MobilityData<a class="anchor" aria-label="anchor" href="#using-mobilitydata"></a>
</h4>
<p>MobilityData.org provide a csv file with all their feed sources on
their <a href="https://github.com/MobilityData/mobility-database-catalogs" class="external-link">GitHub
page</a>.</p>
<p>You can load it in R and browse it as a data frame. Tidytransit
cannot handle GTFS realtime data, so we can remove those entries.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mdb_url</span> <span class="op">=</span> <span class="st">"https://storage.googleapis.com/storage/v1/b/mdb-csv/o/sources.csv?alt=media"</span></span>
<span></span>
<span><span class="va">MobilityData.csv</span> <span class="op">=</span> <span class="kw"><a href="https://rdrr.io/r/base/conditions.html" class="external-link">tryCatch</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="va">mdb_url</span><span class="op">)</span>, </span>
<span>  warning <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">e</span><span class="op">)</span> <span class="op">{</span> <span class="co"># If URL is not reachable, load local dataset</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"mobilitydata.rds"</span>, package <span class="op">=</span> <span class="st">"tidytransit"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="va">MobilityData_feedlist</span> <span class="op">=</span> <span class="va">MobilityData.csv</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">data_type</span> <span class="op">==</span> <span class="st">"gtfs"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">MobilityData_feedlist</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## tibble [2,013 × 27] (S3: tbl_df/tbl/data.frame)</span></span>
<span><span class="co">##  $ mdb_source_id                          : int [1:2013] 1 2 3 4 5 6 7 8 9 10 ...</span></span>
<span><span class="co">##  $ data_type                              : chr [1:2013] "gtfs" "gtfs" "gtfs" "gtfs" ...</span></span>
<span><span class="co">##  $ entity_type                            : chr [1:2013] "" "" "" "" ...</span></span>
<span><span class="co">##  $ location.country_code                  : chr [1:2013] "US" "CA" "CA" "US" ...</span></span>
<span><span class="co">##  $ location.subdivision_name              : chr [1:2013] "Maine" "Ontario" "Ontario" "Ohio" ...</span></span>
<span><span class="co">##  $ location.municipality                  : chr [1:2013] "Casco Bay" "London" "Barrie" "Athens" ...</span></span>
<span><span class="co">##  $ provider                               : chr [1:2013] "Casco Bay Lines" "London Transit Commission" "Barrie Transit" "Athens Public Transit" ...</span></span>
<span><span class="co">##  $ is_official                            : chr [1:2013] "" "" "True" "" ...</span></span>
<span><span class="co">##  $ name                                   : chr [1:2013] "" "" "" "" ...</span></span>
<span><span class="co">##  $ note                                   : chr [1:2013] "" "" "" "" ...</span></span>
<span><span class="co">##  $ feed_contact_email                     : chr [1:2013] "" "croy@londontransit.ca" "" "" ...</span></span>
<span><span class="co">##  $ static_reference                       : chr [1:2013] "" "" "" "" ...</span></span>
<span><span class="co">##  $ urls.direct_download                   : chr [1:2013] "http://smttracker.com/downloads/gtfs/cascobaylines-portland-me-usa.zip" "http://www.londontransit.ca/gtfsfeed/google_transit.zip" "http://www.myridebarrie.ca/gtfs/Google_transit.zip" "https://transitfeeds.com/p/athens-public-transit/298/latest/download" ...</span></span>
<span><span class="co">##  $ urls.authentication_type               : int [1:2013] NA 0 NA NA NA NA NA NA 0 0 ...</span></span>
<span><span class="co">##  $ urls.authentication_info               : chr [1:2013] "" "" "" "" ...</span></span>
<span><span class="co">##  $ urls.api_key_parameter_name            : chr [1:2013] "" "" "" "" ...</span></span>
<span><span class="co">##  $ urls.latest                            : chr [1:2013] "https://storage.googleapis.com/storage/v1/b/mdb-latest/o/us-maine-casco-bay-lines-gtfs-1.zip?alt=media" "https://storage.googleapis.com/storage/v1/b/mdb-latest/o/ca-ontario-london-transit-commission-gtfs-2.zip?alt=media" "https://storage.googleapis.com/storage/v1/b/mdb-latest/o/ca-ontario-barrie-transit-gtfs-3.zip?alt=media" "https://storage.googleapis.com/storage/v1/b/mdb-latest/o/us-ohio-athens-public-transit-gtfs-4.zip?alt=media" ...</span></span>
<span><span class="co">##  $ urls.license                           : chr [1:2013] "" "https://www.londontransit.ca/open-data/ltcs-open-data-terms-of-use/" "https://www.barrie.ca/services-payments/transportation-parking/barrie-transit/barrie-gtfs" "" ...</span></span>
<span><span class="co">##  $ location.bounding_box.minimum_latitude : num [1:2013] 43.7 42.9 44.3 39.3 44.1 ...</span></span>
<span><span class="co">##  $ location.bounding_box.maximum_latitude : num [1:2013] 43.7 43.1 44.4 39.4 45 ...</span></span>
<span><span class="co">##  $ location.bounding_box.minimum_longitude: num [1:2013] -70.2 -81.4 -79.7 -82.1 -75.8 ...</span></span>
<span><span class="co">##  $ location.bounding_box.maximum_longitude: num [1:2013] -70.1 -81.1 -79.6 -82 -74.6 ...</span></span>
<span><span class="co">##  $ location.bounding_box.extracted_on     : chr [1:2013] "2022-02-22T19:51:22+00:00" "2022-02-22T19:51:34+00:00" "2022-03-01T22:43:25+00:00" "2022-03-23T14:43:11+00:00" ...</span></span>
<span><span class="co">##  $ status                                 : chr [1:2013] "inactive" "" "" "deprecated" ...</span></span>
<span><span class="co">##  $ features                               : chr [1:2013] "" "" "" "" ...</span></span>
<span><span class="co">##  $ redirect.id                            : chr [1:2013] "" "" "" "1973" ...</span></span>
<span><span class="co">##  $ redirect.comment                       : chr [1:2013] "" "" "" "" ...</span></span></code></pre>
<p>There is a URL (column <code>urls.direct_download</code>) for each
feed, which can be used to read the feed for a given area directly into
R. For example:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gtfs_path_goldengate</span> <span class="op">&lt;-</span> <span class="va">MobilityData_feedlist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">provider</span> <span class="op">==</span> <span class="st">"Golden Gate Transit"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">urls.direct_download</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gtfs_goldengate</span> <span class="op">=</span> <span class="fu"><a href="../reference/read_gtfs.html">read_gtfs</a></span><span class="op">(</span><span class="va">gtfs_path_goldengate</span><span class="op">)</span></span></code></pre></div>
<p>The MobilityData feedlist contains bounding box coordinates for a
feed which can be used to give a basic impression of the location of
feeds. Note that some bounding boxes might be wrong.</p>
<p>First, let’s create bounding box polygons.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create a bounding box polygon from min/max corner coordinates</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">bbox_polygon</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">lon_min</span>, <span class="va">lon_max</span>, <span class="va">lat_min</span>, <span class="va">lat_max</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">corner_coords</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">lon_min</span>, <span class="va">lat_min</span>,</span>
<span>      <span class="va">lon_min</span>, <span class="va">lat_max</span>,</span>
<span>      <span class="va">lon_max</span>, <span class="va">lat_max</span>,</span>
<span>      <span class="va">lon_max</span>, <span class="va">lat_min</span>,</span>
<span>      <span class="va">lon_min</span>, <span class="va">lat_min</span><span class="op">)</span>,</span>
<span>    ncol <span class="op">=</span> <span class="fl">2</span>, byrow <span class="op">=</span> <span class="cn">T</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="va">polyg</span> <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st.html" class="external-link">st_polygon</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">corner_coords</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/sfc.html" class="external-link">st_sfc</a></span><span class="op">(</span><span class="va">polyg</span>, crs <span class="op">=</span> <span class="fl">4326</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># create bounding box polygon (only for reasonable values)</span></span>
<span><span class="va">MobilityData_sf</span> <span class="op">=</span> <span class="va">MobilityData_feedlist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">location.bounding_box.minimum_longitude</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">location.bounding_box.minimum_latitude</span> <span class="op">&gt;</span> <span class="op">-</span><span class="fl">89</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">mdb_source_id</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>geometry <span class="op">=</span> <span class="fu">bbox_polygon</span><span class="op">(</span><span class="va">location.bounding_box.minimum_longitude</span>,</span>
<span>                                 <span class="va">location.bounding_box.maximum_longitude</span>,</span>
<span>                                 <span class="va">location.bounding_box.minimum_latitude</span>,</span>
<span>                                 <span class="va">location.bounding_box.maximum_latitude</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>These boxes could now be shown on an interactive map.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rstudio.github.io/leaflet/" class="external-link">leaflet</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rstudio.github.io/leaflet/reference/leaflet.html" class="external-link">leaflet</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rstudio.github.io/leaflet/reference/addProviderTiles.html" class="external-link">addProviderTiles</a></span><span class="op">(</span>provider <span class="op">=</span> <span class="va">providers</span><span class="op">$</span><span class="va">CartoDB.Positron</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rstudio.github.io/leaflet/reference/map-layers.html" class="external-link">addPolygons</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">MobilityData_sf</span>, weight <span class="op">=</span> <span class="fl">2</span>, </span>
<span>              fillOpacity <span class="op">=</span> <span class="fl">0.1</span>, label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substr</a></span><span class="op">(</span><span class="va">MobilityData_sf</span><span class="op">$</span><span class="va">provider</span>, <span class="fl">0</span>, <span class="fl">60</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Flavio Poletti, Daniel Herszenhut, Mark Padgham, Tom Buckley, Danton Noriega-Goodwin.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer>
</div>






  </body>
</html>
